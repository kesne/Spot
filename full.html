<canvas id="canvas" width="300" height="300"></canvas>
<script>
enyo = function(r,g,b){
    var componentToHex = function(c) {
        var hex = c.toString(16);
        return hex.length == 1 ? "0" + hex : hex;
    }
    return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
}

function invert(src){
	console.log("Inverting.")
    var common = {};
	     
	canvas = document.getElementById("canvas");
	context = canvas.getContext("2d");
	
	var img = new Image();
	img.crossOrigin = '';
	img.onload = function(){
		context.drawImage(img,0,0);
		var imgd = context.getImageData(0, 0, canvas.width, canvas.height);
		var pix = imgd.data;
		
		// Loop over each pixel and invert the color.
		for (var i = 0, n = pix.length; i < n; i += 4) {
		    var r = pix[i  ]; // red
		    var g = pix[i+1]; // green
		    var b = pix[i+2]; // blue
		    // i+3 is alpha (the fourth element)
		    
		    var hex = enyo(r, g, b);
		    
		    if(hex !== "#000000" && hex !== "#ffffff"){   
			    if(!common[hex]){
			    	common[hex] = 1;
			    }else{
			    	common[hex]++;
			    }
		    }
		}
		
		var sortable = [];
		for (var color in common){
			if(common.hasOwnProperty(color)){
				sortable.push([color, common[color]]);
			}
		}
		sortable.sort(function(a,b){
	    	return a[1] - b[1];
		});
		
	    console.log(sortable[sortable.length-1]);
	};
	img.src = src;
}

invert("assets/facebook.png");

</script>